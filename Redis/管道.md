# 管道

redis提供了许多批量操作的命令来提高效率，如果我们所需要执行的指令不支持批量操作的话，还可以使用管道技术了来提高效率。

管道之所以可以提高效率有两个方面原因

1. 减少网络请求次数
2. 提高QPS——主要原因如下

> Pipeline管道机制不单单是为了减少RTT的一种方式，它实际上大大提高了Redis的QPS。原因是，在没有使用管道机制的情况下，从访问数据结构和产生回复的角度来看，为每个命令提供服务是非常便宜的。但是从底层套接字的角度来看，这是非常昂贵的，这涉及read（）和write（）系统调用，从用户态切换到内核态，这种上下文切换开销是巨大。而使用Pipeline的情况下，通常使用单个read（）系统调用读取许多命令，然后使用单个write（）系统调用传递多个回复,这样就提高了QPS
>
>
> 作者：pjmike_pj
> 链接：https://juejin.im/post/6844903704714297352
> 来源：掘金
> 著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。



需要注意的是， 管道只适应与无因果关联的多命令操作，管道并不是原子性。



## 使用示例

TODO



ref 

- [原理 4：雷厉风行 —— 管道](https://juejin.im/book/6844733724618129422/section/6844733724714598414)
- [Redis学习之管道机制](https://juejin.im/post/6844903704714297352)



