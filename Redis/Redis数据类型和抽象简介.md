#  Redis数据类型和抽象简介

原文地址：[Redis数据类型和抽象简介](https://redis.io/topics/data-types-intro)



Redis实际上是数据结构服务器（*data structures server*）， 支持多种不同类型数据结构，而不是不是简单的键值存储。这意味着，当传统的键值存储服务只能存储字符串与字符串之间的映射时，redis不再限制于存储简单的字符串，有能力处理更加复杂的数据结构。下面是redis支持的数据结构列表，教程后面会分别介绍它们。

- 字符串：二进制安全
- 列表：字符串集合，按元素插入的顺序排列。其存储结构实际上是链表。
- 集合：元素唯一，没有排序的字符串集合
- 有序集合：类似于集合，但是每一个元素都与一个分值（score）相关联。元素总是取分值排序被取出，与集合不同的是有序集合可以按范围取出元素（如取出排前十的元素或者排末尾前十的元素）
- 哈希（Hashes）：键值均为字符串的字典，与ruby、Python中的hashes概念十分接近。
- Bit arrays（bitmaps）：有能力通过特殊命令想处理位数据一样处理字符串，可以单独设置、清除每个位，计算所有设置为1的位，找到第一个设置或者未被只设置的位等等
- HyperLogLogs：这是一个概率数据结构，用于估算集合的基数。别害怕，它比看起来更简单，请参考本教程中相关章节
- Streams：仅追加的字典条目集合，提供了抽象的日志数据类型，在[Introduction to Redis Streams](https://redis.io/topics/streams-intro)有深入介绍

从命令参考中掌握这些数据类型以及如何使用它们来解决问题并不总是那么容易，因此本教程快速讲解redis数据类型以及它们最常用模式。

下面是示例我们将会使用redis-cli工具——一个简单方便的命令行工具，用于发送命令给redis服务器。



## Redis key

redis key是二进制安全的，这意味着你可以使用任何二进制序列作为key，包括字符串如"foo"或是JPEG文件的内容。空字符串同样是有限的key。

一些关于key的规则：

- 非常长的key不是一个明智的做法。例如，一个大小为1024字节的key不仅在内存上不友好，而且在数据集中查找key需要花费更多资源。如果手头的任务中的key非常大， 哈希（例如SHA1算法）后再作为key为更加好，尤其是在内存个带宽的角度来看。
- 非常短的key通常也不是明智的做法。没有理由使用"u1000flw"而不是"user:1000:followers"作为key。后者更加可读并且相对于其存储的来说key占用的内存其实很小。虽然短的key占用的内存更小，但是建议在可读性与内存占用之间取得一个比较好的平衡点。
- 尝试坚持一种模式（作为key的格式）。例如"object-type:id"（<对象>:<id>格式）是一个好的例子， 如"user:100"。常用点或者（英文）破折号作为多字字段的连接符，例如"comment:123:reply.to"或是"comment:123:reply-to"
- key最大允许的大小为512MB

## 字符串

在redis中，字符串是最简单的类型，这是Memcached中唯一支持的数据结构，所以非常对于redis初学者来说使用字符串会非常自然。

redis key 是字符串，因此我们使用字符串时，是将字符串映射到另一个字符串。字符串类型在许多使用场景下非常有用，例如缓存HTMl片段或者页面。

让我们使用redis-cli展示字符串类型的一些使用。

```bash
> set mykey somevalue
OK
> get mykey
"somevalue"
```

如你所见，可以使用SET以及GET命令设置以及取回字符串值。注意SET的key如果事先已经存的话，SET将会覆盖旧值，即使旧值是别的数据类型。

值可以是可以任何类型的字符串（包括二进制数据），例如你可以存储jpeg格式照片作为值。值的大小不可以超过512MB。









疑问

- redis expire 可靠吗（实现原理）以及 expire 策略？

ref

- [二进制安全(binary safe)是什么意思？](https://www.zhihu.com/question/28705562)

